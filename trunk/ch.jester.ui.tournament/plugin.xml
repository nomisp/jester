<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>
<plugin>
   <extension
         point="org.eclipse.ui.newWizards">
      <category
            id="ch.jester.ui.tournament.tournaments"
            name="%NewTournament">
      </category>
      <wizard
            canFinishEarly="true"
            category="ch.jester.ui.tournament.tournaments"
            class="ch.jester.ui.tournament.NewTournamentWizard"
            finalPerspective="ch.jester.rcpapplication.tournamentPerspective"
            hasPages="true"
            icon="icons/tournament_add.png"
            id="ch.jester.ui.tournament.newTournament"
            name="%CreateNewTournament"
            preferredPerspectives="ch.jester.ui.tournament.tournamentPerspective">
         <description>
            Creating a new tournament
         </description>
      </wizard>
   </extension>
   <extension
         point="org.eclipse.ui.menus">
      <menuContribution
            allPopups="false"
            locationURI="menu:ch.jester.ui.add.pulldown">
         <command
               commandId="ch.jester.ui.tournament.newTournament"
               icon="icons/tournament_add.png"
               label="%CreateNewTournament"
               style="push">
         </command>
      </menuContribution>
      <menuContribution
            allPopups="false"
            locationURI="popup:ch.jester.ui.tournament.cnf.popup?after=group.edit">
         <command
               commandId="org.eclipse.ui.edit.delete"
               icon="icons/tournament_delete.png"
               id="cnf.popup.delete"
               label="%DeleteTournament"
               mnemonic="D"
               style="push">
         </command>
         <command
               commandId="cnf.popup.addPlayer"
               icon="icons/player_add.png"
               label="%AddPlayer"
               mnemonic="A"
               style="push"
               tooltip="%TTaddPlayer">
         </command>
         <command
               commandId="ch.jester.ui.tournament.pairing"
               icon="icons/pairing_go.png"
               label="%RunPairing"
               style="push"
               tooltip="%TTrunPairing">
         </command>
         <command
               commandId="ch.jester.ui.tournament.edittournament"
               icon="icons/settings.png"
               label="%EditTournament"
               style="push"
               tooltip="%TTEditTournament">
         </command>
      </menuContribution>
   </extension>
   <extension
         point="org.eclipse.ui.commands">
      <command
            defaultHandler="ch.jester.common.ui.handlers.WizardCallingHandler"
            id="ch.jester.ui.tournament.newTournament"
            name="%CreateNewTournament">
      </command>
      <command
            description="%WirePlayerToCategoryDescr"
            id="cnf.popup.addPlayer"
            name="%AddPlayer">
      </command>
      <command
            description="%RunPairingDescr"
            id="ch.jester.ui.tournament.pairing"
            name="%RunPairing">
      </command>
      <command
            description="%%EditTournamentDescr"
            id="ch.jester.ui.tournament.edittournament"
            name="%EditTournament">
      </command>
   </extension>
   <extension
         point="org.eclipse.ui.views">
      <view
            class="ch.jester.ui.tournament.cnf.TournamentNavigator"
            icon="icons/navigator_16x16.png"
            id="ch.jester.ui.tournament.cnf.view"
            name="%TournamentNavigator"
            restorable="true">
      </view>
   </extension>
   <extension
         point="org.eclipse.ui.navigator.navigatorContent">
     <navigatorContent
           activeByDefault="true"
           contentProvider="ch.jester.ui.tournament.cnf.TournamentContentProvider"
           icon="icons/tournament.png"
           id="ch.jester.ui.tournament.cnf.TournamentContent"
           labelProvider="ch.jester.ui.tournament.cnf.TournamentLabelProvider"
           name="Tournament content"
           priority="normal">
	      <triggerPoints>
	      	<or>
	      		<instanceof value="ch.jester.model.Root"/>
	      		<instanceof value="ch.jester.model.Tournament"/>
	      	</or>
	      </triggerPoints>
	      <possibleChildren>
	      	<or>
	      		<instanceof value="ch.jester.model.Tournament"/>
	      		<instanceof value="ch.jester.model.Category"/>
	      		<instanceof value="ch.jester.model.Player"/>
         <instanceof
               value="ch.jester.model.Round">
         </instanceof>
         <instanceof
               value="ch.jester.model.Pairing">
         </instanceof>
         <instanceof
               value="ch.jester.ui.tournament.cnf.TournamentContentProvider$PlayerFolder">
         </instanceof>
	      	</or>
		  </possibleChildren>
	   </navigatorContent>
   </extension>
   <extension
         point="org.eclipse.ui.navigator.viewer">
         <viewer
		       viewerId="ch.jester.ui.tournament.cnf.view">
            <popupMenu
                  allowsPlatformContributions="true"
                  id="ch.jester.ui.tournament.cnf.popup">
               <insertionPoint
                     name="group.new"
                     separator="false">
               </insertionPoint>
               <insertionPoint
                     name="group.open"
                     separator="false">
               </insertionPoint>
               <insertionPoint
                     name="group.edit"
                     separator="true">
               </insertionPoint>
            </popupMenu>
		 </viewer>
		 <viewerContentBinding
		       viewerId="ch.jester.ui.tournament.cnf.view">
		    <includes>
		       <contentExtension
		             isRoot="false"
		             pattern="ch.jester.ui.tournament.cnf.TournamentContent">
		       </contentExtension>
		    </includes>
		 </viewerContentBinding>
   </extension>
   <extension
         point="org.eclipse.ui.handlers">
      <handler
            class="ch.jester.ui.tournament.handler.AddPlayerHandler"
            commandId="cnf.popup.addPlayer">
         <activeWhen>
            <reference
                  definitionId="ch.jester.ui.tournament.categorySelected">
            </reference>
         </activeWhen>
         <enabledWhen>
            <reference
                  definitionId="ch.jester.ui.tournament.categorySelected">
            </reference>
         </enabledWhen>
      </handler>
      <handler
            class="ch.jester.ui.tournament.handler.PairingHandler"
            commandId="ch.jester.ui.tournament.pairing">
         <activeWhen>
            <reference
                  definitionId="ch.jester.ui.tournament.categorySelected">
            </reference>
         </activeWhen>
         <enabledWhen>
            <reference
                  definitionId="ch.jester.ui.tournament.categorySelected">
            </reference>
         </enabledWhen>
      </handler>
      <handler
            class="ch.jester.ui.tournament.handler.EditTournamentHandler"
            commandId="ch.jester.ui.tournament.edittournament">
         <activeWhen>
            <reference
                  definitionId="ch.jester.ui.tournament.tournamentSelected">
            </reference>
         </activeWhen>
      </handler>
   </extension>
   <extension
         point="org.eclipse.core.expressions.definitions">
      <definition
            id="ch.jester.ui.tournament.tournamentSelected">
         <with
               variable="selection">
            <iterate
                  ifEmpty="false"
                  operator="or">
               <instanceof
                     value="ch.jester.model.Tournament">
               </instanceof>
            </iterate>
         </with>
      </definition>
      <definition
            id="ch.jester.ui.tournament.cnf.oneElementSelected">
         <with
               variable="selection">
            <count
                  value="1">
            </count>
         </with>
      </definition>
      <definition
            id="ch.jester.ui.tournament.categorySelected">
         <with
               variable="selection">
            <iterate
                  ifEmpty="false"
                  operator="or">
               <instanceof
                     value="ch.jester.model.Category">
               </instanceof>
            </iterate>
         </with>
      </definition>
   </extension>
   <extension
         point="org.eclipse.ui.editors">
      <editor
            class="ch.jester.ui.tournament.editors.WirePlayerEditor"
            default="false"
            icon="icons/player_add.png"
            id="ch.jester.ui.tournament.wirePlayerEditor"
            name="%WirePlayerEditor">
      </editor>
   </extension>

</plugin>
